import{o as h,f as A,h as k,s as N,$ as t,p as B,i as L,j as q,d as F,k as _}from"./index.fc35cc64.js";var E={"":["<em>","</em>"],_:["<strong>","</strong>"],"*":["<strong>","</strong>"],"~":["<s>","</s>"],"\n":["<br />"]," ":["<br />"],"-":["<hr />"]};function P(n){return n.replace(RegExp("^"+(n.match(/^(\t| )+/)||"")[0],"gm"),"")}function $(n){return(n+"").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function w(n,s){var l,u,e,g,a,y=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,o=[],p="",f=s||{},m=0;function d(c){var r=E[c[1]||""],i=o[o.length-1]==c;return r?r[1]?(i?o.pop():o.push(c),r[0|i]):r[0]:c}function C(){for(var c="";o.length;)c+=d(o[o.length-1]);return c}for(n=n.replace(/^\[(.+?)\]:\s*(.+)$/gm,function(c,r,i){return f[r.toLowerCase()]=i,""}).replace(/^\n+|\n+$/g,"");e=y.exec(n);)u=n.substring(m,e.index),m=y.lastIndex,l=e[0],u.match(/[^\\](\\\\)*\\$/)||((a=e[3]||e[4])?l='<pre class="code '+(e[4]?"poetry":e[2].toLowerCase())+'"><code'+(e[2]?' class="language-'+e[2].toLowerCase()+'"':"")+">"+P($(a).replace(/^\n+|\n+$/g,""))+"</code></pre>":(a=e[6])?(a.match(/\./)&&(e[5]=e[5].replace(/^\d+/gm,"")),g=w(P(e[5].replace(/^\s*[>*+.-]/gm,""))),a==">"?a="blockquote":(a=a.match(/\./)?"ol":"ul",g=g.replace(/^(.*)(\n|$)/gm,"<li>$1</li>")),l="<"+a+">"+g+"</"+a+">"):e[8]?l='<img src="'+$(e[8])+'" alt="'+$(e[7])+'">':e[10]?(p=p.replace("<a>",'<a href="'+$(e[11]||f[u.toLowerCase()])+'">'),l=C()+"</a>"):e[9]?l="<a>":e[12]||e[14]?l="<"+(a="h"+(e[14]?e[14].length:e[13]>"="?1:2))+">"+w(e[12]||e[15],f)+"</"+a+">":e[16]?l="<code>"+$(e[16])+"</code>":(e[17]||e[1])&&(l=d(e[17]||"--"))),p+=u,p+=l;return(p+n.substring(m)+C()).replace(/^\n+|\n+$/g,"")}function j({gv:n}){const[s,l]=h(A(n)),[u,e]=h({}),[g,a]=h([]),[y,o]=h(""),[p,f]=h(""),m=k({}),[d,C]=h(!1);N(()=>{const r=F(s),i=_(s);Promise.all([r,i]).then(([v,x])=>{e(v.result);const b=I(v.result.videos||"");a(b),b.length>0&&o(b[0][1]),f(x.result.pv),m.current.innerHTML=w(v.result.content)})},[s]);const c=r=>{l(r)};return t("main",null,t("div",{class:"wrap player"},t("div",{className:"ep-wrap"},t(S,{url:y})),t("div",{className:"p"},t("div",{className:"avatar"},t("img",{src:L(u.uqq),alt:""}),t("p",null,u.uname)),t("ul",null,g.map((r,i)=>t("li",{onClick:v=>c(v.target.value)},i))))),t("div",{className:"info"},t("h1",null,u.title),t("div",{className:"tag"},t("p",null,p," \u2103"),t("div",{className:"tags"},u.tag&&u.tag.split(" ").filter(r=>r.length>0).map(r=>t("li",null,r)),t("li",{onclick:()=>C(!d)},"\u5C55\u5F00\u8BE6\u60C5 ",d?"\u2BC5":"\u2BC6"),t("li",{onclick:()=>B(`/upload/${s}`)},"\u7F16\u8F91\u7A3F\u5B50 \u2BC8"))),t("article",{ref:m,style:{display:d?"block":"none"}})))}function I(n){return n.split(`
`).map(s=>s.split("$")).filter(s=>s.length>0&&s[1]!=null)}function S(n){const s=k(null);return N(()=>{q(`https://api.clicli.cc/play?url=${n.url}`).then(l=>{const u=l.result.mtype==="m3u8"?"hls":l.result.mtype;s.current.setAttribute("type",u),s.current.setAttribute("src",l.result.url)})},[n.url]),t("e-player",{ref:s,class:"ep"})}export{S as Eplayer,j as default};
