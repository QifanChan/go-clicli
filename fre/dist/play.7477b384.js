import{f as k,l as f,h as P,s as N,Y as n,p as x,i as A,j as B,d as L,k as q}from"./index.298e33b7.js";var F={"":["<em>","</em>"],_:["<strong>","</strong>"],"*":["<strong>","</strong>"],"~":["<s>","</s>"],"\n":["<br />"]," ":["<br />"],"-":["<hr />"]};function C(l){return l.replace(RegExp("^"+(l.match(/^(\t| )+/)||"")[0],"gm"),"")}function v(l){return(l+"").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function w(l,s){var t,i,e,m,r,y=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,c=[],p="",d=s||{},g=0;function $(a){var u=F[a[1]||""],h=c[c.length-1]==a;return u?u[1]?(h?c.pop():c.push(a),u[0|h]):u[0]:a}function o(){for(var a="";c.length;)a+=$(c[c.length-1]);return a}for(l=l.replace(/^\[(.+?)\]:\s*(.+)$/gm,function(a,u,h){return d[u.toLowerCase()]=h,""}).replace(/^\n+|\n+$/g,"");e=y.exec(l);)i=l.substring(g,e.index),g=y.lastIndex,t=e[0],i.match(/[^\\](\\\\)*\\$/)||((r=e[3]||e[4])?t='<pre class="code '+(e[4]?"poetry":e[2].toLowerCase())+'"><code'+(e[2]?' class="language-'+e[2].toLowerCase()+'"':"")+">"+C(v(r).replace(/^\n+|\n+$/g,""))+"</code></pre>":(r=e[6])?(r.match(/\./)&&(e[5]=e[5].replace(/^\d+/gm,"")),m=w(C(e[5].replace(/^\s*[>*+.-]/gm,""))),r==">"?r="blockquote":(r=r.match(/\./)?"ol":"ul",m=m.replace(/^(.*)(\n|$)/gm,"<li>$1</li>")),t="<"+r+">"+m+"</"+r+">"):e[8]?t='<img src="'+v(e[8])+'" alt="'+v(e[7])+'">':e[10]?(p=p.replace("<a>",'<a href="'+v(e[11]||d[i.toLowerCase()])+'">'),t=o()+"</a>"):e[9]?t="<a>":e[12]||e[14]?t="<"+(r="h"+(e[14]?e[14].length:e[13]>"="?1:2))+">"+w(e[12]||e[15],d)+"</"+r+">":e[16]?t="<code>"+v(e[16])+"</code>":(e[17]||e[1])&&(t=$(e[17]||"--"))),p+=i,p+=t;return(p+l.substring(g)+o()).replace(/^\n+|\n+$/g,"")}function V({gv:l}){const s=k(l),[t,i]=f({}),[e,m]=f([]),[r,y]=f(""),[c,p]=f(""),d=P({}),[g,$]=f(!1);return N(()=>{const o=L(s),a=q(s);Promise.all([o,a]).then(([u,h])=>{i(u.result);const b=_(u.result.videos||"");m(b),b.length>0&&y(b[0][1]),p(h.result.pv),d.current.innerHTML=w(u.result.content)})},[]),n("main",null,n("div",{class:"wrap player"},n("div",{className:"ep-wrap"},n(E,{url:r})),n("div",{className:"p"},n("div",{className:"avatar"},n("img",{src:A(t.uqq),alt:""}),n("p",null,t.uname)),n("ul",null,e.map((o,a)=>n("li",null,a))))),n("div",{className:"info"},n("h1",null,t.title),n("div",{className:"tag"},n("p",null,c," \u2103"),n("div",{className:"tags"},t.tag&&t.tag.split(" ").filter(o=>o.length>0).map(o=>n("li",null,o)),n("li",{onclick:()=>$(!g)},"\u5C55\u5F00\u8BE6\u60C5 ",g?"\u2BC5":"\u2BC6"),n("li",{onclick:()=>x(`/upload/${s}`)},"\u7F16\u8F91\u7A3F\u5B50 \u2BC8"))),n("article",{ref:d,style:{display:g?"block":"none"}})))}function _(l){return l.split(`
`).map(s=>s.split("$")).filter(s=>s.length>0&&s[1]!=null)}function E(l){const s=P(null);return N(()=>{B(`https://api.clicli.cc/play?url=${l.url}`).then(t=>{const i=t.result.mtype==="m3u8"?"hls":t.result.mtype;s.current.setAttribute("type",i),s.current.setAttribute("src",t.result.url)})},[l.url]),n("e-player",{ref:s,class:"ep"})}export{E as Eplayer,V as default};
